<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.67.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>River</title>
  <meta name="description" content="秋风江上作渔竿" />

  
  <link type="text/css" rel="stylesheet" href="http://riverlee2014.github.iocss/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="http://riverlee2014.github.iocss/poole.css">
  <link type="text/css" rel="stylesheet" href="http://riverlee2014.github.iocss/syntax.css">
  <link type="text/css" rel="stylesheet" href="http://riverlee2014.github.iocss/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="http://riverlee2014.github.io/index.xml" rel="alternate" type="application/rss+xml" title="River" />
  
</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="http://riverlee2014.github.io"><h1>River</h1></a>
      <p class="lead">
       秋风江上作渔竿 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="http://riverlee2014.github.io">Home</a> </li>
        <li><a href="https://github.com/riverlee2014"> Github </a></li>
      </ul>
    </nav>

    <p>&copy; 2020. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="posts">
<article class="post">
  <h1 class="post-title">
    <a href="http://riverlee2014.github.io/post/consul-dns-srv/">Consul DNS SRV 服务发现</a>
  </h1>
  <time datetime="2020-01-13T16:24:33&#43;0800" class="post-date">Mon, Jan 13, 2020</time>
  前言 根据 Consul 官方文档的说明，它提供了二种类型的 API 接口：HTTP / DNS 。HTTP 是非常容易理解的应用场景，基本上大多数开发语言的 Client SDK 都是基于 HTTP 接口封装的。而本文的重点是实验另一种接口 DNS ，以及它可能的应用场景。
DNS 是一种非常古老的协议，在网络发展史上已经存在比较久，基本上现代大多数操作系统都内置了解析 DNS 的功能。DNS 也是有服务发现、负载均衡、权重控制等能力。最常见的 Linux 发行版下都带有 dig、nslookup 等命令，用来探测解析 DNS 域名。下面，我们来了解一下 Consul DNS API 的玩法。
准备 假设您已经正确安装完一个 consul cluster，现在先正常注册一个 service 上去。比如，您机器上装了一个服务叫做 hugo，端点提供在 1313 端口。注册信息：
{&#34;service&#34;: {&#34;name&#34;: &#34;hugo&#34;,&#34;tags&#34;: [&#34;sit&#34;],&#34;port&#34;: 1313,&#34;check&#34;: {&#34;tcp&#34;: &#34;127.0.0.1:1313&#34;,&#34;interval&#34;: &#34;10s&#34;,&#34;timeout&#34;: &#34;1s&#34;}}}注册成功，UI 看起来像如下：
查询 consul 的默认 dns 接口暴露在 8600 端口上，而操作系统默认的 DNS 端口为 53 （ 需要 root 权限才能暴露），我们先用 8600 进行 DNS查询：
  
  <div class="read-more-link">
    <a href="/post/consul-dns-srv/">Read More…</a>
  </div>
  
</article>
</div>
    </main>

    
      
    
  </body>
</html>
